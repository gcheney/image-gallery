(function(){angular.module("imageGalleryApp",["ngRoute","ngSanitize","ui.bootstrap"]);function e(e,t){e.when("/",{templateUrl:"home/home.view.html",controller:"homeController",controllerAs:"vm"}).when("/about",{templateUrl:"/common/views/genericText.view.html",controller:"aboutController",controllerAs:"vm"}).when("/images/:imageid",{templateUrl:"/imageDetail/imageDetail.view.html",controller:"imageDetailController",controllerAs:"vm"}).when("/register",{templateUrl:"/auth/register/register.view.html",controller:"registerController",controllerAs:"vm"}).otherwise({redirectTo:"/"});t.html5Mode(true)}angular.module("imageGalleryApp").config(["$routeProvider","$locationProvider",e])})();(function(){angular.module("imageGalleryApp").controller("homeController",e);e.$inject=["$scope","imageGalleryData"];function e(e,t){var r=this;r.pageHeader={title:"The Image Gallery",subtitle:"A user supported collection of beautiful images"};r.message="Loading images...";t.getAllImages().success(function(e){r.message=e.length>0?"":"No images found";r.data={images:e}}).error(function(e){r.message="Sorry, there was an error with our system";console.log(e)});r.showError=function(t){e.$apply(function(){r.message=t.message})}}})();(function(){angular.module("imageGalleryApp").controller("aboutController",e);function e(){var e=this;e.pageHeader={title:"About The Image Gallery"};e.main={content:'The Image Gallery was created by Glendon Cheney as a place for people to upload their favorite images.\n\n It was created using the MEAN stack, is open source and maintained on <a href="https://github.com/gcheney/image-gallery">Github.</a>'}}})();(function(){angular.module("imageGalleryApp").controller("registerController",e);e.$inject=["$location","authentication"];function e(e,t){var r=this;r.pageHeader={title:"Register for Image Gallery"};r.credentials={username:"",password:""};r.returnPage=e.search().page||"/";r.onSubmit=function(){r.formError="";if(!r.credentials.username||!r.credentials.password){r.formError="All fields required, please try again";return false}else{r.doRegister()}};r.doRegister=function(){r.formError="";t.register(r.credentials).error(function(e){r.formError=e}).then(function(){e.search("page",null);e.path(r.returnPage)})}}})();(function(){angular.module("imageGalleryApp").controller("imageDetailController",e);e.$inject=["$routeParams","$modal","imageGalleryData"];function e(e,t,r){var a=this;a.imageid=e.imageid;r.getImageById(a.imageid).success(function(e){a.data={image:e}}).error(function(e){console.log(e)});a.commentModal=function(){var e=t.open({templateUrl:"/commentModal/commentModal.view.html",controller:"commentModalController as vm",resolve:{imageData:function(){return{imageid:a.imageid,imageTitle:a.data.image.title}}}});e.result.then(function(e){a.data.image.comments.push(e)})}}})();(function(){angular.module("imageGalleryApp").controller("commentModalController",e);e.$inject=["$modalInstance","imageGalleryData","imageData"];function e(e,t,r){var a=this;a.imageData=r;a.onSubmit=function(){a.formError="";if(!a.formData){a.formError="All fields are required.";return false}else if(!a.formData.name){a.formError="Please include your name.";return false}else if(!a.formData.content){a.formError="Please leave a comment.";return false}else{a.addComment(a.imageData.imageid,a.formData)}};a.addComment=function(e,r){t.addCommentById(e,{author:r.name,content:r.content}).success(function(e){a.modal.close(e)}).error(function(e){a.formError="Comment not saved, please try again."});return false};a.modal={close:function(t){e.close(t)},cancel:function(){e.dismiss("cancel")}}}})();(function(){angular.module("imageGalleryApp").service("imageGalleryData",e);e.$inject=["$http"];function e(e){var t=function(){return e.get("/api/images")};var r=function(t){return e.get("/api/images/"+t)};var a=function(t,r){return e.post("/api/images/"+t+"/comments",r)};return{getAllImages:t,getImageById:r,addCommentById:a}}})();(function(){angular.module("imageGalleryApp").service("authentication",e);e.$inject=["$window","$http"];function e(e,t){var r=function(t){e.localStorage["imageGallery-token"]=t};var a=function(){return e.localStorage["imageGallery-token"]};var n=function(e){return t.post("/api/register",e).success(function(e){r(e.token)})};var o=function(e){return t.post("/api/login",e).success(function(e){r(e.token)})};var i=function(){e.localStorage.removeItem("loc8r-token")};var l=function(){var t=a();if(t){var r=JSON.parse(e.atob(t.split(".")[1]));return r.exp>Date.now()/1e3}else{return false}};var m=function(){if(l()){var t=a();var r=JSON.parse(e.atob(t.split(".")[1]));return{email:r.email,name:r.name}}};return{saveToken:r,getToken:a,register:n,login:o,logout:i,isLoggedIn:l,currentUser:m}}})();(function(){angular.module("imageGalleryApp").directive("footerBasic",e);function e(){return{restrict:"EA",templateUrl:"/common/directives/footerBasic/footerBasic.template.html"}}})();(function(){angular.module("imageGalleryApp").directive("imageHover",e);function e(){return{restrict:"EA",link:function(e,t,r){t.hover(function(){$(this).addClass("transition")},function(){$(this).removeClass("transition")})}}}})();(function(){angular.module("imageGalleryApp").directive("navigation",e);function e(){return{restrict:"EA",templateUrl:"/common/directives/navigation/navigation.template.html"}}})();(function(){angular.module("imageGalleryApp").directive("pageHeader",e);function e(){return{restrict:"EA",scope:{content:"=content"},templateUrl:"/common/directives/pageHeader/pageHeader.template.html"}}})();(function(){angular.module("imageGalleryApp").filter("addHtmlLineBreaks",e);function e(){return function(e){return e.replace(/\n/g,"<br/>")}}})();